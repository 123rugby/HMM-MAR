\hypertarget{hidden__state__inference__mx_8cpp}{}\section{/\+Users/gilesc/src/\+H\+M\+M-\/\+M\+A\+R/hidden\+\_\+state\+\_\+inference/hidden\+\_\+state\+\_\+inference\+\_\+mx.cpp File Reference}
\label{hidden__state__inference__mx_8cpp}\index{/\+Users/gilesc/src/\+H\+M\+M-\/\+M\+A\+R/hidden\+\_\+state\+\_\+inference/hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp@{/\+Users/gilesc/src/\+H\+M\+M-\/\+M\+A\+R/hidden\+\_\+state\+\_\+inference/hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp}}


Mex interface for hidden state inference in V\+B-\/\+H\+MM.  


{\ttfamily \#include \char`\"{}hidden\+\_\+state\+\_\+inference\+\_\+mx.\+hpp\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{hidden__state__inference__mx_8cpp_a6a215cbfde54f82a3ce599228fc3fce5}{mex\+Function} (int nlhs, mx\+Array $\ast$plhs\mbox{[}$\,$\mbox{]}, int nrhs, const mx\+Array $\ast$prhs\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Mex interface for hidden state inference using forward-\/backward algorithm. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Mex interface for hidden state inference in V\+B-\/\+H\+MM. 

Hidden state inference for V\+B-\/solved H\+MM, using the forwards-\/backwards algorithm.

To use this file, you may need to recompile, changing the top of the makefile to reflect your matlab installation

Copyright 2016 O\+H\+BA

This program is free software\+: you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program. If not, see \href{http://www.gnu.org/licenses/}{\tt http\+://www.\+gnu.\+org/licenses/}.

\$\+Last\+Changed\+By\$ \$\+Revision\$ \$\+Last\+Changed\+Date\$ Contact\+: \href{mailto:giles.colclough@ohba.ox.ac.uk}{\tt giles.\+colclough@ohba.\+ox.\+ac.\+uk} Originally written on\+: M\+A\+C\+I64 by Giles Colclough, 14-\/\+Jul-\/2015 

\subsection{Function Documentation}
\index{hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp@{hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp}!mex\+Function@{mex\+Function}}
\index{mex\+Function@{mex\+Function}!hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp@{hidden\+\_\+state\+\_\+inference\+\_\+mx.\+cpp}}
\subsubsection[{\texorpdfstring{mex\+Function(int nlhs, mx\+Array $\ast$plhs[], int nrhs, const mx\+Array $\ast$prhs[])}{mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])}}]{\setlength{\rightskip}{0pt plus 5cm}void mex\+Function (
\begin{DoxyParamCaption}
\item[{int}]{nlhs, }
\item[{mx\+Array $\ast$}]{plhs\mbox{[}$\,$\mbox{]}, }
\item[{int}]{nrhs, }
\item[{const mx\+Array $\ast$}]{prhs\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{hidden__state__inference__mx_8cpp_a6a215cbfde54f82a3ce599228fc3fce5}{}\label{hidden__state__inference__mx_8cpp_a6a215cbfde54f82a3ce599228fc3fce5}


Mex interface for hidden state inference using forward-\/backward algorithm. 

mex\+Function(int num\+\_\+outputs, mx\+Array$\ast$ outputs, int num\+\_\+inputs, mx\+Array$\ast$ inputs)

H\+I\+D\+D\+E\+N\+\_\+\+S\+T\+A\+T\+E\+\_\+\+I\+N\+F\+E\+R\+E\+N\+CE using foward-\/backward propagation

\mbox{[}G\+A\+M\+MA,XI,S\+C\+A\+LE\mbox{]} = H\+I\+D\+D\+E\+N\+\_\+\+S\+T\+A\+T\+E\+\_\+\+I\+N\+F\+E\+R\+E\+N\+C\+E(\+B, P\+I\+\_\+0, P, O\+R\+D\+E\+R)

returns the probability of each state given the data, G\+A\+M\+MA, and the probability of each state given the parents and children, XI, together with the scalings on alpha, S\+C\+A\+LE.

The function uses the marginal likelihood of the data given the priors for each state, the initial probabilities, P\+I\+\_\+0, and the transition probability matrix A. There is also an order term, relevant for M\+AR models. If you\textquotesingle{}re not using a M\+AR model, set order = 0.

You M\+U\+ST have four inputs and three outputs. If you don\textquotesingle{}t want to make / assign variables, use $\sim$ as a dummy variable e.\+g. \mbox{[}g,x,$\sim$\mbox{]} = hidden\+\_\+state\+\_\+inference\+\_\+mx(\+B,\+P\+I,\+P,\+O\+R\+D\+E\+R) 